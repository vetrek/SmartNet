---
phase: 02-exact-path-matching
plan: 01
type: execute
---

<objective>
Implement ExactPathMatcher that matches only exact path strings.

Purpose: Enable middleware to target specific paths without matching subpaths (e.g., `/users` matches only `/users`, not `/users/123`).
Output: ExactPathMatcher struct with factory method and comprehensive unit tests.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context:
@.planning/phases/01-path-matching-foundation/01-01-SUMMARY.md

# Key files:
@Source/Core/PathMatcher.swift
@Tests/UnitTests/PathMatcherTests.swift

**Patterns established in Phase 1:**
- PathMatcher protocol: `matches(path:) -> Bool`, `pattern: String`, Sendable conformance
- Factory methods via constrained protocol extension: `PathMatcher.exact(_:)`
- Struct implementation with public init and let property for pattern

**Constraining decisions:**
- Phase 1: pathMatcher property with default implementation for backward compatibility
- Phase 1: Factory method pattern for ergonomic matcher creation
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ExactPathMatcher implementation</name>
  <files>Source/Core/PathMatcher.swift</files>
  <action>
Add ExactPathMatcher struct below ContainsPathMatcher in PathMatcher.swift.

Implementation requirements:
- Struct conforming to PathMatcher protocol (already Sendable via protocol)
- `let pattern: String` property
- `public init(pattern: String)` initializer
- `matches(path:)` that normalizes both pattern and path before comparing:
  - Strip leading "/" from both if present
  - Strip trailing "/" from both if present
  - Compare strings exactly (case-sensitive)
- Pattern "/" should match only "/" or "" (empty path)

Add factory method via protocol extension after ContainsPathMatcher's extension:
```swift
public extension PathMatcher where Self == ExactPathMatcher {
  static func exact(_ path: String) -> ExactPathMatcher {
    ExactPathMatcher(pattern: path)
  }
}
```

Include docstring matching existing style with usage examples.
  </action>
  <verify>swift build succeeds without errors</verify>
  <done>ExactPathMatcher struct exists with matches(path:) logic and factory method, builds successfully</done>
</task>

<task type="auto">
  <name>Task 2: Add ExactPathMatcher unit tests</name>
  <files>Tests/UnitTests/PathMatcherTests.swift</files>
  <action>
Add test cases for ExactPathMatcher after existing ContainsPathMatcher tests.

Test cases to add (following existing test style with @Test annotations):

1. "Exact matcher matches identical path" - `/users` matches `/users`
2. "Exact matcher does not match subpaths" - `/users` does NOT match `/users/123`
3. "Exact matcher does not match parent paths" - `/users/123` does NOT match `/users`
4. "Exact matcher handles leading slash normalization" - `users` matches `/users` and vice versa
5. "Exact matcher handles trailing slash normalization" - `/users/` matches `/users`
6. "Exact matcher is case sensitive" - `/Users` does NOT match `/users`
7. "Exact global pattern matches only root" - `/` matches only `/` and ``
8. "Factory method creates correct matcher" - `.exact("/users")` works correctly
9. "Exact matcher handles empty path" - pattern "users" does NOT match ""

Use MARK comment `// MARK: - ExactPathMatcher Tests` to separate from ContainsPathMatcher tests.
  </action>
  <verify>swift test --filter PathMatcherTests passes all tests</verify>
  <done>All ExactPathMatcher tests pass, covering exact matching, normalization, and edge cases</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `swift build` succeeds without errors or warnings
- [ ] `swift test --filter PathMatcherTests` passes all tests (existing + new)
- [ ] `swift test` passes all project tests (no regressions)
- [ ] ExactPathMatcher matches exact paths only, not subpaths or parent paths
</verification>

<success_criteria>

- ExactPathMatcher struct implemented following PathMatcher protocol
- Factory method `PathMatcher.exact(_:)` available
- Unit tests verify exact matching behavior vs subpath matching
- All existing tests continue to pass
- Phase 2 complete
</success_criteria>

<output>
After completion, create `.planning/phases/02-exact-path-matching/02-01-SUMMARY.md` following the frontmatter format from 01-01-SUMMARY.md:

---
phase: 02-exact-path-matching
plan: 01
subsystem: middleware
tags: [pathMatcher, exact, middleware, routing]

requires: [01-path-matching-foundation]
provides:
  - ExactPathMatcher for exact path matching
  - Factory method PathMatcher.exact(_:)
affects: []

tech-stack:
  added: []
  patterns: []

key-files:
  created: []
  modified:
    - Source/Core/PathMatcher.swift
    - Tests/UnitTests/PathMatcherTests.swift

key-decisions: []

patterns-established: []

issues-created: []

duration: Xmin
completed: YYYY-MM-DD
---

# Phase 2 Plan 01: Exact Path Matching Summary

**[One-liner summary]**

## Performance
...
</output>
